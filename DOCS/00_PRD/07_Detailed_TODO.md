# 7. Detailed TODO - stages, atomic tasks with metadata

| ID   | Task                                     | Input                  | Process                                 | Output                | Prior. | Estimate | Dependencies | Acceptance Criteria                                                   |
| ---- | ---------------------------------------- | ---------------------- | --------------------------------------- | --------------------- | ------ | -------- | ------------- | -------------------------------------------------------------------- |
| R1   | Configure AudioSession (PlayAndRecord)   | none                   | Config, interruption/route notifications| active session        | High   | 4h       | —             | Recording/playback not interrupted, correct pause on call            |
| R2   | Recording pipeline on AVAudioEngine      | RecordingSettings      | inputNode→converter→AVAudioFile         | .m4a file             | High   | 2d       | R1            | File playable, duration accurate (±50ms/hour)                        |
| R3   | Pause/resume recording                   | state                  | stop buffer without closing file        | updated file          | High   | 6h       | R2            | No clicks, timer counts total time                                   |
| R4   | Meters L/R (RMS/Peak, 20–30 Hz)          | audio buffers          | tap+DSP                                 | values for UI         | High   | 1d       | R2            | Real-time, no lags, CPU < 10%                                        |
| R5   | Recording source (route picker)          | routes                 | select via AVAudioSession               | active source         | Med    | 6h       | R1            | Switch without crash, indication                                     |
| R6   | Current recording metadata               | name/path              | update JSON                             | meta file             | Med    | 4h       | R2            | Name, size, format, time update                                      |
| P1   | Playback pipeline                       | file                   | playerNode+timePitch+mixer              | sound                 | High   | 2d       | R1            | Plays all supported files, position accurate                         |
| P2   | Progress/position                        | timer                  | poll playerTime                         | UI update             | High   | 6h       | P1            | No drift (>0.5s/hour)                                                |
| P3   | Seek tap ±10s                            | gesture                | nudge                                  | new position          | High   | 4h       | P1            | Steps accurate, no sound clipping                                    |
| P4   | Seek with hold                           | gesture                | repeat nudge/200ms + "with sound"       | fast navigation       | Med    | 8h       | P1,P3         | Clear feedback, lag <100ms                                           |
| P5   | DPC Rate/Pitch                           | values                 | config AVAudioUnitTimePitch             | modified sound        | High   | 1d       | P1            | No artifacts, switch on‑the‑fly                                      |
| P6   | Master and L/R Volume                    | values                 | mixer gains/panner                      | changed level         | Med    | 1d       | P1            | Linear response, no clipping                                         |
| P7   | A‑B Loop                                 | A/B                    | loop in render/timer                    | looping               | Med    | 1d       | P1,P2         | No clicks at loop transition                                         |
| UI1  | Screen according to layout               | design                 | SwiftUI components                      | pixel-perfect         | High   | 3d       | P2,R4         | Match spacing, colors, sizes                                        |
| UI2  | Waveform Live                            | RMS/Peak               | Canvas/Metal                            | graph                 | High   | 2d       | R4            | Frequency ≥30 FPS, smooth                                            |
| UI3  | Waveform Offline                         | file                   | pre-calc + cache                        | preview               | Med    | 2d       | P1,FS1        | Fast list scroll, cache <5% disk                                     |
| FM1  | Catalog structure                        | none                   | /Documents/Recordings                   | directory             | High   | 2h       | —             | Permissions, backup policy ok                                        |
| FM2  | File list                                | disk                   | FileManager+AVAsset                     | [FileMeta]            | High   | 1d       | FM1           | All attributes filled                                                |
| FM3  | Copy/Delete/Rename                       | id                     | background operations                    | new id                | Med    | 1d       | FM2           | UI does not block                                                    |
| FM4  | Free space                               | —                      | URLResourceValues                       | bytes                 | Low    | 2h       | FM1           | Value correct                                                        |
| BM1  | Bookmarks T‑MARK                         | pos                    | append → meta.json                      | bookmarks[]           | Med    | 1d       | P2,FM2        | Visible and selectable in UI                                         |
| ST1  | Recording settings                       | UI                     | UserDefaults+JSON                       | RecordingSettings     | Med    | 1d       | R2            | Applied to new recording                                             |
| SEC1 | UI Lock                                  | gesture                | overlay + haptics                       | anti‑misclick         | Med    | 6h       | UI1           | Unlock by holding 2s                                                 |
| QA1  | AudioCore unit tests                     | —                      | XCTest                                  | report                | High   | 1d       | core          | Key paths covered                                                    |
| QA2  | Basic UI tests                           | —                      | XCUITest                                | report                | Med    | 1d       | UI1           | Minimum regression                                                   |
| QA3  | Stress/endurance tests (long recording, battery, low storage, large library) | app, device, mock data | Automated/manual long-duration, high-volume, and resource-constrained scenarios | QA stress report | High | 2d | QA1, QA2 | Verified stability, data integrity, error handling, and UI responsiveness under all stress conditions |
